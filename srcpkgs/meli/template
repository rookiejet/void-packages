# Template file for 'meli'
pkgname=meli
version=0.8.11
revision=1
build_style=cargo
configure_args="--no-default-features
	--features sqlite3,smtp,jmap
	$(vopt_if notmuch '--features notmuch')
	$(vopt_if gpg '--features gpgme')
	$(vopt_if notifications '--features dbus-notifications')"
make_install_args="--path meli"
make_check_args="--features cli-docs"
hostmakedepends="pkg-config mdocml"
makedepends="openssl-devel
	$(vopt_if notifications 'dbus-devel')"
depends="$(vopt_if gpg 'libgpgme')
	$(vopt_if notmuch 'libnotmuch')
	m4"
checkdepends="m4"
short_desc="Terminal email client with support for multiple accounts and maildir"
maintainer="Mazin Fadl <mazen@illumed.net>"
license="GPL-3.0-or-later"
homepage="https://meli.delivery/"
distfiles="https://git.meli-email.org/meli/meli/archive/v$version.tar.gz"
checksum=675f8f40baad50124db6449ce53edf6db0204218f74fb8ac1a335cbbb89d5f03

build_options="gpg notmuch notifications"
build_options_default="gpg notmuch notifications"
desc_option_gpg="Enable gpg support via libgpgme"
desc_option_notmuch="Enable support for using notmuch as a mail backend"
desc_option_notifications="Build support for showing notifications using dbus"

post_install() {
	vman meli/docs/meli.1
	vman meli/docs/meli.7
	vman meli/docs/meli.conf.5
	vman meli/docs/meli-themes.5

	vdoc meli/docs/external-tools.md

	vinstall meli/docs/mail.vim 644 usr/share/vim/vimfiles/after/ftplugin
	vinstall meli/docs/mail.vim 644 usr/share/nvim/runtime/after/ftplugin

	vcopy meli/docs/samples usr/share/meli
}
